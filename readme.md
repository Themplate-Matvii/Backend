# **Template Backend**

–ú–æ–¥—É–ª—å–Ω–∞—è, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è **SaaS/Marketplace** –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–∞
**Node.js + TypeScript + Express + MongoDB**,
–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:

* –ø–æ–¥–ø–∏—Å–∫–∏ + –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏,
* –±–∏–ª–ª–∏–Ω–≥ –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é —Å Stripe,
* —Å–∏—Å—Ç–µ–º—É —Ä–æ–ª–µ–π –∏ permissions,
* –º–æ–¥—É–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –ø–æ–∑–≤–æ–ª—è—é—â—É—é –ª–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å –ø—Ä–æ–µ–∫—Ç.

---

# üìÇ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø—É **Domain-Driven Modules** ‚Äî –∫–∞–∂–¥—ã–π –¥–æ–º–µ–Ω –∏–º–µ–µ—Ç —Å–≤–æ–∏:

* –º–æ–¥–µ–ª–∏,
* —Å–µ—Ä–≤–∏—Å—ã,
* –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã,
* —Ä–æ—É—Ç—ã,
* –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É.

–ù–∏–∂–µ ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –º–æ–¥—É–ª–µ–π:

```
src/
  modules/
    billing/
      pricing/
      payments/
        providers/
          base/
          stripe/
      subscriptions/
      types/

    bonus/
    core/
    landings/

    user/
      index/
      auth/
      settings/

    communication/
      feedback/
      email/

    assets/
      media/

    analytics/
      business/
      traffic/
```

---

# üß© **–û–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π**

## üì¶ **billing/**

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏.

### **billing/pricing/**

–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞:

* –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤:

  * **–ø–æ–¥–ø–∏—Å–∫–∏ (`plans`)**
  * **–æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏ (`oneTimeProducts`)**
* –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ñ—Ä–æ–Ω—Ç–∞
* —Å–∫–ª–µ–π–∫—É –¥–∞–Ω–Ω—ã—Ö: –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã + –ø—Ä–æ–≤–∞–π–¥–µ—Ä (Stripe)

### **billing/payments/**

–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞:

* —Å–æ–∑–¥–∞–Ω–∏–µ checkout-—Å–µ—Å—Å–∏–π –≤ Stripe
* —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–ª–∞—Ç
* —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤:**

```
payments/
  providers/
    base/      ‚Äî –±–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—Å–µ—Ö –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
    stripe/    ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è Stripe
```

### **billing/subscriptions/**

–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:

* —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
* –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (active, canceled, expired)
* –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω—ã–º–∏ webhook

### **billing/types/**

–û–±—â–∏–µ enum‚Äô—ã –∏ —Ç–∏–ø—ã:

* `PaymentMode`
* `ProviderWebhookEventType`
* `BonusSourceType`
* billing –º–æ–¥–µ–ª–∏

---

## üéÅ **bonus/**

–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –±–æ–Ω—É—Å—ã, –≤—ã–¥–∞–≤–∞–µ–º—ã–µ:

* –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ –ø–æ–¥–ø–∏—Å–∫–∏
* –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ one-time —Ç–æ–≤–∞—Ä–∞

---

## üß© **core/**

–°–∏—Å—Ç–µ–º–Ω—ã–µ –º–æ–¥—É–ª–∏, —É—Ç–∏–ª–∏—Ç—ã, middleware, —è–¥—Ä–æ –ø—Ä–æ–µ–∫—Ç–∞.

---

## üì∞ **landings/**

CRUD –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–µ–Ω–¥–∏–Ω–≥–∞–º–∏.

---

## üë§ **user/**

–ú–æ–¥—É–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ —Ç—Ä–∏ —á–∞—Å—Ç–∏:

```
user/
  index/      ‚Äî –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, /me, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
  auth/       ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏–Ω, refresh tokens, OAuth
  settings/   ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Ç–µ–º–∞, —è–∑—ã–∫, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
```

---

## üí¨ **communication/**

–†–∞–±–æ—Ç–∞ —Å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–µ–π:

```
communication/
  feedback/   ‚Äî –æ—Ç–∑—ã–≤—ã, NPS, —Ñ–æ—Ä–º—ã –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
  email/      ‚Äî email-—Ä–∞—Å—Å—ã–ª–∫–∏ (–æ–¥–∏–Ω–æ—á–Ω–∞—è –∏ –º–∞—Å—Å–æ–≤–∞—è)
```

---

## üóÇ **assets/**

–•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –º–µ–¥–∏–∞:

```
assets/
  media/
```

---

## üìä **analytics/**

–î–≤–µ –∫–ª—é—á–µ–≤—ã–µ –ø–æ–¥—Å–∏—Å—Ç–µ–º—ã:

```
analytics/
  business/   ‚Äî –¥–æ—Ö–æ–¥, MRR, ARPU, –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
  traffic/    ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä—ã, –ø–µ—Ä–µ—Ö–æ–¥—ã, —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

---

# ‚öôÔ∏è **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫**

* **Node.js + TypeScript**
* **Express**
* **MongoDB + Mongoose**
* **Stripe API** (–ø–æ–¥–ø–∏—Å–∫–∏, –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –ø–æ–∫—É–ø–∫–∏)
* JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
* Role + Permissions —Å–∏—Å—Ç–µ–º–∞
* i18n –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

---

# üîÑ **–ë–∏–ª–ª–∏–Ω–≥: –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö**

### 1) –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å Stripe

```
constants (plans + oneTimeProducts)
        ‚Üì
pricingService
        ‚Üì
stripeProvider.sync()
        ‚Üì
BillingProductModel
```

---

### 2) –°–æ–∑–¥–∞–Ω–∏–µ checkout-—Å–µ—Å—Å–∏–∏

```
paymentService ‚Üí createCheckoutSession(planKey/productKey)
        ‚Üì
stripeProvider ‚Üí checkout.sessions.create()
```

---

### 3) Webhook Stripe

```
stripe ‚Üí webhook
        ‚Üì
stripeProvider.handleWebhook()
        ‚Üì
paymentModel
subscriptionService
bonusService
```

---

# üîê **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è**

–ú–æ–¥—É–ª—å `user/auth` –≤–∫–ª—é—á–∞–µ—Ç:

* —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é
* –ª–æ–≥–∏–Ω
* refresh-—Å–µ—Å—Å–∏–∏
* logout
* OAuth-–ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã (Google, Apple)
* –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–∞–≤ —á–µ—Ä–µ–∑ middleware `checkPermission`

---

# üì° –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ `/api/me`

```json
{
  "user": {
    "id": "123",
    "email": "test@example.com",
    "role": "user",
    "plan": "basic"
  },
  "permissions": {
    "landings": {
      "create": true,
      "own": { "view": true, "edit": true, "delete": true },
      "any": { "view": false, "edit": false, "delete": false }
    },
    "feedback": { "view": true },
    "email": { "one": false, "broadcast": false }
  }
}
```

---

# üß± –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è:

* SaaS-—Å–µ—Ä–≤–∏—Å–æ–≤
* no-code / low-code –ø–ª–∞—Ç—Ñ–æ—Ä–º
* –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤
* AI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
* 
